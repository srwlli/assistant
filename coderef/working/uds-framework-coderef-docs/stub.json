{
  "feature_name": "uds-framework-coderef-docs",
  "title": "UDS Framework Integration into coderef-docs MCP",
  "description": "Extract Papertrail's UDS (Universal Documentation System) framework and integrate into coderef-docs MCP to provide formalized document type schemas, validation, and governance for all generated documentation.",
  "category": "feature",
  "priority": "high",
  "created": "2025-12-26",
  "status": "planning",
  "context": "CodeRef currently has UDS in practice (ARCHITECTURE.md, API.md, DELIVERABLES.md templates exist) but not formalized in code. Papertrail's uds.ts (18.8 KB, zero dependencies) defines document types, required sections, placeholder tokens, and validation rules. Integrating UDS into coderef-docs enables: (1) objective documentation governance (validate before commit), (2) guides AI Generator to create UDS-compliant docs automatically, (3) consistent structure across all document types and projects, (4) enforcement via /validate-docs MCP tool.",
  "problem_statement": "Currently: Document templates are living examples in markdown. Agents write docs without formal validation. No enforcement of structure. Consistency varies by agent. AI-generated docs have no guarantees of completeness.",
  "solution_approach": "Extract uds.ts from Papertrail (C:\\Users\\willh\\Desktop\\ARCHIVED\\projects-idle\\paper-trail-parsed-into-modules\\uds-framework\\uds.ts). Adapt for CodeRef. Integrate into coderef-docs MCP with three components: (1) UDS schema module defining README, ARCHITECTURE, API, DELIVERABLES, COMPONENTS, SCHEMA, QUICKREF types with required sections and tokens, (2) UDSValidator class for validation, (3) /validate-docs MCP tool for agents to check docs before commit.",
  "document_types": [
    {
      "type": "README",
      "required_sections": [
        "Overview",
        "Features",
        "Installation",
        "Usage",
        "API Reference"
      ],
      "tokens": [
        "{{PROJECT_NAME}}",
        "{{AUTHOR}}",
        "{{CREATED_DATE}}",
        "{{VERSION}}"
      ]
    },
    {
      "type": "ARCHITECTURE",
      "required_sections": [
        "System Overview",
        "Components",
        "Data Flow",
        "Design Decisions"
      ],
      "tokens": [
        "{{WORKORDER_ID}}",
        "{{FEATURE_NAME}}",
        "{{PHASE_COUNT}}",
        "{{DEPENDENCIES}}"
      ]
    },
    {
      "type": "DELIVERABLES",
      "required_sections": [
        "Overview",
        "Implementation Phases",
        "Deliverables Checklist",
        "Metrics",
        "Success Criteria"
      ],
      "tokens": [
        "{{FEATURE_NAME}}",
        "{{WORKORDER_ID}}",
        "{{CREATED_DATE}}",
        "{{TOTAL_TASKS}}",
        "{{LINES_OF_CODE}}",
        "{{GIT_COMMITS}}"
      ]
    },
    {
      "type": "API",
      "required_sections": [
        "Endpoints",
        "Request/Response Schemas",
        "Authentication",
        "Error Handling"
      ],
      "tokens": [
        "{{BASE_URL}}",
        "{{API_VERSION}}",
        "{{AUTHENTICATION_SCHEME}}"
      ]
    },
    {
      "type": "COMPONENTS",
      "required_sections": [
        "Component Overview",
        "Component List",
        "Dependencies",
        "Usage Examples"
      ],
      "tokens": [
        "{{PROJECT_NAME}}",
        "{{COMPONENT_COUNT}}"
      ]
    },
    {
      "type": "SCHEMA",
      "required_sections": [
        "Entity Overview",
        "Entity Definitions",
        "Relationships",
        "Constraints"
      ],
      "tokens": [
        "{{DATABASE_TYPE}}",
        "{{SCHEMA_VERSION}}"
      ]
    }
  ],
  "implementation_steps": [
    "Extract uds.ts from Papertrail codebase",
    "Adapt to CodeRef structure (remove Papertrail-specific code)",
    "Define all document types CodeRef uses (README, ARCHITECTURE, API, DELIVERABLES, COMPONENTS, SCHEMA, QUICKREF)",
    "Create UDSValidator class (check required sections, validate tokens)",
    "Create /validate-docs MCP tool: usage: /validate-docs {file_path} {doc_type}",
    "Integrate with AI Generator (ensure generated docs are UDS-compliant)",
    "Add pre-commit hook to validate docs before agents commit",
    "Document UDS spec for agent reference"
  ],
  "deliverables": [
    "uds.ts - Schema definitions for all document types",
    "validator.ts - UDSValidator class with validation logic",
    "MCP tool: /validate-docs - Check document compliance",
    "Integration with ai-generator.ts - Guides AI output",
    "Documentation - UDS spec guide for agents"
  ],
  "benefits": [
    "Documentation governance - objective validation instead of subjective review",
    "Consistency - same structure across all projects and agents",
    "Enforcement - automatic validation prevents incomplete docs",
    "AI guidance - UDS schema tells AI Generator what sections are required",
    "Searchability - uniform structure enables better indexing",
    "Team standards - single source of truth for doc format"
  ],
  "integration_points": [
    "coderef-docs MCP - Add /validate-docs tool",
    "ai-generator (Papertrail module) - Use UDS schema in prompt",
    "git pre-commit - Optional hook to validate before commit",
    "agent workflow - Show validation results in feedback"
  ],
  "dependencies": [
    "Papertrail uds.ts (18.8 KB, zero external dependencies)",
    "Existing coderef-docs MCP structure",
    "Optional: git pre-commit hook framework"
  ],
  "effort_estimate": {
    "extraction": "30 minutes",
    "adaptation": "30 minutes",
    "validator_implementation": "1 hour",
    "mcp_integration": "1 hour",
    "testing": "1 hour",
    "total": "4 hours"
  },
  "success_criteria": [
    "UDS schema defines all doc types CodeRef uses",
    "Validator correctly identifies missing sections",
    "Validator correctly identifies unfilled tokens",
    "/validate-docs MCP tool works end-to-end",
    "AI Generator produces UDS-compliant output",
    "Pre-commit validation prevents incomplete docs",
    "100% of generated docs pass validation"
  ],
  "future_enhancements": [
    "Custom UDS extensions for specialized doc types",
    "UDS compliance reporting dashboard",
    "Documentation diff tracking (what changed in each version)",
    "Template auto-generation from UDS schema",
    "Multi-language UDS support"
  ],
  "papertrail_reference": {
    "source_file": "C:\\Users\\willh\\Desktop\\ARCHIVED\\projects-idle\\paper-trail-parsed-into-modules\\uds-framework\\uds.ts",
    "size": "18.8 KB",
    "dependencies": "None (pure TypeScript)",
    "related_files": [
      "ai-documentation.ts (uses UDS)",
      "template-engine-extended.ts (fills UDS tokens)"
    ]
  },
  "related_stubs": {
    "STUB-058": {
      "name": "mcp-doc-standards-integration",
      "relationship": "Complementary - STUB-064 defines document structure (what goes inside), STUB-058 defines document metadata (headers/footers with attribution)",
      "workflow": "STUB-064 creates the document body with UDS-compliant sections \u2192 STUB-058 wraps it with standard headers/footers",
      "implementation_order": "Implement STUB-064 first (structure), then STUB-058 (metadata wrapper)",
      "example": {
        "step_1_uds_structure": "DELIVERABLES requires: [Overview, Phases, Checklist, Metrics, Success]",
        "step_2_content_generation": "AI Generator creates content following UDS schema",
        "step_3_header_footer": "STUB-058 adds: generated_by, workorder_id, feature_id, timestamp (header) + next_review_date, workorder_reference (footer)",
        "result": "Complete, governed document with structure + attribution"
      },
      "shared_tokens": [
        "{{WORKORDER_ID}}",
        "{{FEATURE_NAME}}",
        "{{CREATED_DATE}}"
      ]
    }
  },
  "target_project": "coderef-docs",
  "stub_id": "STUB-135"
}