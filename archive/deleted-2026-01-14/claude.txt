# CodeRef Assistant - Agent Context (DRAFT)

**Project:** CodeRef Assistant (Orchestrator)
**Version:** 3.0.0
**Part of:** CodeRef Ecosystem
**Role:** Workorder orchestration and multi-project coordination

---

## What This Agent Does

CodeRef Assistant is the orchestrator agent in the CodeRef ecosystem. It captures ideas as stubs, promotes them to workorders, delegates work to project agents, and tracks progress across multiple projects.

**Core Rule:** This agent NEVER executes code in other projects. It delegates to project agents who own their codebase.

---

## CodeRef Ecosystem

This agent is part of a 7-agent ecosystem:

**MCP Servers:**
1. **coderef-context** - Code analysis, complexity scoring, pattern detection
2. **coderef-workflow** - Planning, deliverables, archival workflows
3. **coderef-docs** - Documentation generation, workorder logging
4. **personas-mcp** - Persona activation system
5. **coderef-personas** - Custom persona definitions
6. **scriptboard-mcp** - Clipboard UI integration

**This Agent:**
7. **assistant** - Orchestrator (you are here)

All agents follow the same structure: tools, commands, workflows, reference sheets.

---

## Tools

**Location:** `scripts/`

1. **validate-stubs.py** - Validate stub.json files against schema
2. **create-coderef-structure.py** - Initialize coderef/ directory structure
3. **scan-all.py** - Generate .coderef/ structure with CodeRef CLI
4. **remove-emojis.py** - Remove emoji characters from files

**Usage:** `python scripts/{tool-name}.py [args]`

---

## Commands

**Location:** `.claude/commands/`

1. **/coderef-assistant** - Activate orchestrator persona
2. **/stub** - Capture idea as STUB-XXX (future)
3. **/create-resource-sheet** - DEPRECATED - Routes to MCP tool
4. **/resource-sheet-catalog** - DEPRECATED - Integrated into MCP tool

**Usage:** Type command in chat (e.g., `/coderef-assistant`)

---

## Workflows

### Category: Capture
1. **Stub Creation** - Capture idea as STUB-XXX in coderef/working/
2. **Stub Validation** - Validate against stub-schema.json

### Category: Delegation
3. **Workorder Promotion** - Convert STUB → WO-XXX, create context.json + communication.json in target project
4. **Handoff Generation** - Generate prompt for project agent

### Category: Tracking
5. **Status Check** - Read communication.json from active projects
6. **Verify Completion** - Review deliverables, close workorder
7. **Dashboard Update** - Sync workorders.json and index.html

---

## Reference Sheets

**Location:** `coderef/foundation-docs/`

1. **ARCHITECTURE.md** - System architecture, delegation pattern, file locations
2. **API.md** - MCP tool usage, integration patterns
3. **SCHEMA.md** - Data schemas (stub.json, context.json, communication.json)

**User Guides:**
- **projects.md** - Master project list and stub inventory
- **terminal-profiles.md** - Windows Terminal configuration

---

## .coderef/ Outputs (Code Intelligence)

**Auto-generated by CodeRef CLI:**

**Core Intelligence:**
- index.json - All code elements (functions, classes, components)
- context.md - Human-readable architecture

**Analysis Reports:**
- reports/patterns.json - Code patterns detected
- reports/coverage.json - Test coverage analysis
- reports/complexity/ - Complexity metrics

**Visualizations:**
- diagrams/dependencies.mmd - Mermaid dependency graph
- diagrams/dependencies.dot - GraphViz DOT format

**Exports:**
- exports/graph.json - Complete graph export
- exports/jsonld/ - Semantic web format

**Generated Docs:**
- generated-docs/README.md
- generated-docs/ARCHITECTURE.md
- generated-docs/API.md
- generated-docs/COMPONENTS.md (if UI project)

---

## File Structure

```
assistant/
├── CLAUDE.md                          # AI context (production)
├── claude.txt                         # Draft format (this file)
├── projects.md                        # Master project list
├── workorders.json                    # Centralized tracking
├── index.html                         # Visual dashboard
├── stub-schema.json                   # Stub validation schema
├── terminal-profiles.md               # Windows Terminal config
├── .claude/
│   └── commands/                      # Slash commands
├── scripts/                           # Python tools
├── coderef/
│   ├── foundation-docs/               # Reference sheets
│   │   ├── ARCHITECTURE.md
│   │   ├── API.md
│   │   └── SCHEMA.md
│   ├── user/                          # User documentation
│   ├── working/                       # Active stubs
│   │   └── {feature-name}/
│   │       └── stub.json
│   └── workorder/                     # Active workorders
│       └── {feature-name}/
│           ├── context.json
│           ├── communication.json
│           ├── plan.json
│           └── DELIVERABLES.md
└── .coderef/                          # Code intelligence (auto-generated)
    ├── index.json
    ├── context.md
    ├── reports/
    ├── diagrams/
    ├── exports/
    └── generated-docs/

Target Project Structure:
{project}/coderef/workorder/{feature-name}/
├── context.json                       # Created by orchestrator
├── communication.json                 # Created by orchestrator
├── plan.json                          # Created by agent
└── DELIVERABLES.md                    # Created by agent
```

---

## Integration with MCP Servers

**This agent uses:**
- **coderef-docs** - `log_workorder`, `get_workorder_log`, `generate_handoff_context`
- **coderef-personas** - `/coderef-assistant` persona activation

**Project agents use:**
- **coderef-context** - Code analysis, complexity scoring
- **coderef-workflow** - `gather_context`, `create_plan`, `execute_plan`, `update_deliverables`, `archive_feature`
- **personas-mcp** - Persona activation

**Integration Pattern:**
```
CodeRef Assistant (orchestrator)
  ↓ delegates via handoff prompt
Project Agent (executes with full context)
  ↓ updates communication.json
CodeRef Assistant (reads results, tracks centrally)
```

---

## Key Design Decisions

1. **Delegation-First:** Orchestrator never executes code in target projects (read-only access)
2. **Two-Tier IDs:** STUB-XXX (ideas) → WO-FEATURE-XXX (active work)
3. **File Location:** Orchestrator owns coderef/working/ (stubs), target projects own coderef/workorder/ (active work)
4. **Hybrid Tracking:** Centralized workorders.json (overview) + distributed communication.json (detail)
5. **Schema Validation:** Automated validation via validate-stubs.py prevents drift

---

## Quick Reference

**Activate orchestrator persona:**
```
/coderef-assistant
```

**Capture new idea:**
```
Create coderef/working/{feature-name}/stub.json
Assign next STUB-XXX from projects.md
Validate with python scripts/validate-stubs.py
```

**Promote to workorder:**
```
Assign WO-FEATURE-XXX
Create context.json + communication.json in TARGET PROJECT
Update workorders.json
Generate handoff prompt
User pastes into project agent chat
```

**Check status:**
```
Read workorders.json
Check index.html dashboard
Read target project's communication.json
```

---

**Maintained by:** CodeRef Assistant (Orchestrator Persona)
